# 产品需求文档 (PRD)

## 1. 升级记录 (Upgrade Record)
**页面路径**: `upgrade-record`
**主要组件**: `src/components/UpgradeRecord.vue`, `src/view/UpdateList.vue`

### 1.1 基础功能
*   **记录列表展示**:
    *   展示每日升级记录，字段包含：序号、国家、升级内容（支持富文本/链接）、影响范围、研发人员、测试人员、更新时间（北京时间及当地时间）。
    *   **智能解析**: 支持从文本中通过正则自动解析国家、时间、人员等信息。
*   **查询与筛选**:
    *   支持按“开始时间”和“结束时间”筛选。
    *   支持按“国家/地区”筛选（如美国、巴西、OA等）。
*   **新增/编辑记录**:
    *   弹窗表单填写，支持多选国家、平台、测试人员、更新人。
    *   内容输入支持富文本编辑器（Quill），支持粘贴图片自动上传。
*   **快捷操作**:
    *   **复制昨日上线内容**: 前端自动过滤并复制最近两天的数据到剪贴板。
    *   **复制截图**: 自动生成当前表格的截图并复制到剪贴板（使用 `html2canvas`）。
    *   **导出 Excel**: 将当前列表数据导出为 Excel 文件。
    *   **发送到群**: 支持将单条记录通过钉钉接口发送通知。
*   **复盘功能**:
    *   针对特定记录发起复盘，填写复盘内容和结论，指派复盘人员（产品经理）。

### 1.2 API 接口
| 功能 | 请求方式 | 接口路径 | 关键参数 |
| :--- | :--- | :--- | :--- |
| **获取列表** | POST | `/api.php?table=upgrade_record&action=list` | `start_time`, `end_time`, `country` |
| **新增记录** | POST | `/api.php?table=upgrade_record&action=create` | `country`, `content`, `updater`, `tester`, ... |
| **更新记录** | PUT | `/api.php?table=upgrade_record&action=update&id={id}` | 同上 |
| **删除记录** | DELETE | `/api.php?table=upgrade_record&action=delete&id={id}` | `id` |
| **获取用户列表** | GET | `/api.php?table=user` | 无 (用于下拉选项) |
| **上传图片** | POST | `/UploadImage.php` | `image` (base64), `type`, `record_id` |
| **发送钉钉** | POST | `/api.php?table=upgrade_record&action=sendDingTalkText` | `id` |
| **获取复盘信息** | GET | `/api.php?table=review_record&action=get&id={id}` | `id` |
| **保存复盘** | POST/PUT | `/api.php?table=review_record&action=create` (或 `update`) | `record_id`, `review_content`, `conclusion` |

---

## 2. 复盘记录 (Review Record)
**页面路径**: `review-record`
**主要组件**: `src/components/ReviewRecord.vue`

### 2.1 基础功能
*   **记录列表展示**:
    *   展示复盘会议记录，字段包含：日期、发起人、参与人、目的、结论（富文本）、下一步计划、价值评估（有/无/常规）、价值体现。
*   **查询与筛选**: 支持按日期范围查询。
*   **新增/编辑记录**:
    *   使用富文本编辑器记录结论。
    *   **智能提取**: 支持从富文本内容中自动正则提取“目的”、“发起人”、“参会人”、“结论”等字段填入表单。
*   **导出与分享**:
    *   **复制截图**: 生成表格截图。
    *   **导出 Excel**: 导出记录。

### 2.2 API 接口
| 功能 | 请求方式 | 接口路径 | 关键参数 |
| :--- | :--- | :--- | :--- |
| **获取列表** | POST | `/api.php?table=chen_yaopu_review&action=list` | `start_date`, `end_date` |
| **新增记录** | POST | `/api.php?table=chen_yaopu_review&action=create` | `date`, `purpose`, `content`, `valuable`, ... |
| **更新记录** | PUT | `/api.php?table=chen_yaopu_review&action=update&id={id}` | 同上 |
| **删除记录** | DELETE | `/api.php?table=chen_yaopu_review&action=delete&id={id}` | `id` |
| **获取用户列表** | POST | `/api.php?table=user&action=list` | 无 |
| **上传图片** | POST | `/UploadImage.php` | `image`, `type: review` |

---

## 3. 跟进任务 (Follow Up Task)
**页面路径**: `follow-up-task`
**主要组件**: `src/components/FollowUpTask.vue`, `src/view/FollowUpSubTask.vue`, `src/view/FollowUpMainTask.vue`

该页面包含两个标签页：**日常跟进信息 (Sub Task)** 和 **主任务信息 (Main Task)**。

### 3.1 日常跟进信息 (Sub Task)
*   **功能**:
    *   展示子任务列表，支持按主任务分组显示（合并单元格）。
    *   支持按创建日期、主任务筛选。
    *   **一键完成**: 快速将任务标记为完成（状态置为1，结束日期设为今天）。
    *   **拷贝昨日任务**: 从服务端拷贝昨日未完成的任务。
    *   **截图并复制**: 针对表格特定列生成截图。
    *   **发送到钉钉**: 将特定主任务下的子任务发送到钉钉群。
*   **API 接口**:
    | 功能 | 请求方式 | 接口路径 | 关键参数 |
    | :--- | :--- | :--- | :--- |
    | **获取列表** | POST | `/api.php?table=follow_up_sub_tasks&action=list` | `creation_date`, `parent_task_ids` |
    | **新增任务** | POST | `/api.php?table=follow_up_sub_tasks&action=create` | `parent_task_id`, `sub_task_content`, ... |
    | **更新任务** | PUT | `/api.php?table=follow_up_sub_tasks&action=update&id={id}` | 同上 |
    | **删除任务** | DELETE | `/api.php?table=follow_up_sub_tasks&action=delete&id={id}` | `id` |
    | **拷贝昨日** | POST | `/api.php?table=follow_up_sub_tasks&action=copy_yesterday` | 无 |
    | **发送钉钉** | POST | `/api.php?table=follow_up_sub_tasks&action=sendDingTalkText` | `parent_task_id`, `main_task_content` |

### 3.2 主任务信息 (Main Task)
*   **功能**:
    *   管理主任务（父任务）列表。
    *   字段包含：任务内容、创建日期、结束日期。
*   **API 接口**:
    | 功能 | 请求方式 | 接口路径 | 关键参数 |
    | :--- | :--- | :--- | :--- |
    | **获取列表** | POST | `/api.php?table=follow_up_main_tasks` | `start_date`, `end_date` |
    | **新增主任务** | POST | `/api.php?table=follow_up_main_tasks&action=create` | `task_content`, `end_date` |
    | **更新主任务** | PUT | `/api.php?table=follow_up_main_tasks&action=update&id={id}` | 同上 |
    | **删除主任务** | DELETE | `/api.php?table=follow_up_main_tasks&action=delete&id={id}` | `id` |

---

## 4. 用户管理 (User Management)
**页面路径**: `user-management`
**主要组件**: `src/components/UserManagement.vue`

### 4.1 基础功能
*   **用户列表**: 展示用户 ID、用户名、职位。
*   **用户操作**: 新增用户、编辑用户信息、删除用户。
*   **作用**: 该模块的数据被其他模块（如升级记录、复盘记录）用于提供“研发人员”、“测试人员”、“产品经理”等下拉选项。

### 4.2 API 接口
| 功能 | 请求方式 | 接口路径 | 关键参数 |
| :--- | :--- | :--- | :--- |
| **获取列表** | GET | `/api.php?table=user` | 无 |
| **新增用户** | POST | `/api.php?table=user&action=create` | `username`, `position` |
| **更新用户** | PUT | `/api.php?table=user&action=update&id={id}` | `username`, `position` |
| **删除用户** | DELETE | `/api.php?table=user&action=delete&id={id}` | `id` |
